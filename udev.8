.TH UDEV 8 "October 2003" "" "Linux Administrator's Manual"
.SH NAME
udev \- Linux configurable dynamic device naming support
.SH SYNOPSIS
.BI udev " hotplug-subsystem"
.SH "DESCRIPTION"
.B udev
creates or removes device node files usually located in the /dev directory.
Its goal is to provide a dynamic device directory that contains only the files
for devices that are actually present.
.P
As part of the
.B hotplug
subsystem,
.B udev
is executed if a kernel device is added or removed from the system.
On device creation,
.B udev
reads the sysfs directory of the given device to collect device attributes
like label, serial number or bus device number.
These attributes are treated as a key 
to determine a unique name for device file creation.
.B udev
maintains a database for devices present on the system.
.br
On device removal,
.B udev
queries the internal database for the name of the device file to be deleted.
.SH "CONFIGURATION"
All udev configuration files consist of a set of lines of text.  All empty
lines, and lines beginning with a '#' will be ignored.
.P

.B udev
expects its main configuration file at
.I /etc/udev/udev.conf.
The file consists of a set of variables and values that allow the user to
override default udev values.  The current set of variables that can be
overridden in this file is:
.TP
.B udev_root
This is the where in the filesystem to place the device nodes.  The default
value for this is
.I /udev/
.TP
.B udev_db
The name and location of the udev database.  The default value for this is
.I /udev/.udev.tdb
.TP
.B udev_rules
This is the location of the udev rules file.  The default value for this is
.I /etc/udev/udev.rules
.TP
.B udev_permissions
This is the location of the udev permission file.  The default value for this is
.I /etc/udev/udev.permissions
.TP
.B default_mode
This is the default mode for all nodes that have no explicit match in the
permissions file.  The default value for this is
.I 0666
.br
.P
A sample \fIudev.conf\fP might look like this:
.sp
.nf
# udev_root - where in the filesystem to place the device nodes
udev_root="/udev/"

# udev_db - The name and location of the udev database.
udev_db="/udev/.udev.tdb"

# udev_rules - The name and location of the udev rules file
udev_rules="/etc/udev/udev.rules"

# udev_permissions - The name and location of the udev permission file
udev_permissions="/etc/udev/udev.permissions"

# default_mode - set the default mode for all nodes that have no 
#                explicit match in the permissions file
default_mode="0666"
.fi
.P
The rules for udev to use when naming devices may specified at
.I /etc/udev/udev.rules
or specified by the 
.I udev_rules
value in the 
.I /etc/udev/udev.conf
file.
.P
Every line in the rules file define the mapping between device attributes and
the device file name. It starts with a keyword defining the method used to
match, followed by one ore more keys to compare and the filename for the
device. If no matching configuration is found, the default kernel device name
is used.
.P
The line format is:
.RS
.sp
.I method, key,[key,...] name
.sp
.RE
where valid methods with corresponding keys are:
.TP
.B CALLOUT
calling external program, that returns a string to match
.br
keys: \fBBUS\fP, \fBPROGRAM\fP, \fBID\fP
.TP
.B LABEL
device label or serial number, like USB serial number, SCSI UUID or
file system label
.br
keys: \fBBUS\fP, \fIsysfs_attribute\fP
.TP
.B NUMBER
device number on the bus, like PCI bus id
.br
keys: \fBBUS\fP, \fBID\fP
.TP
.B TOPOLOGY
device position on bus, like physical port of USB device
.br
keys: \fBBUS\fP, \fBPLACE\fP
.TP
.B REPLACE
string replacement of the kernel device name
.br
key: \fBKERNEL_NAME\fP
.P
The methods are applied in the following order:
.B CALLOUT
,
.B LABEL
,
.B NUMBER
,
.B TOPOLOGY
,
.B REPLACE
.P
The 
.B NAME 
and 
.B PROGRAM 
fields support simple printf-like string subtitution:
.RS
.TP
.B %n
the "kernel number" of the device
for example, 'sda3' has a "kernel number" of '3'
.TP
.B %M
the kernel major number for the device
.TP
.B %m
the kernel minor number for the device
.TP
.B %b
the bus id for the device
.TP
.B %c
the CALLOUT program returned string
(this does not work within the PROGRAM field for the obvious reason.)
.TP
.B %D
Use the devfs style disk name for this device.
For partitions, this will result in 'part%n'
If this is not a partition, it will result in 'disk'
.RE
.P
A sample \fIudev.rules\fP might look like this:
.sp
.nf
# if /sbin/scsi_id returns "OEM 0815" device will be called disk1
CALLOUT, BUS="scsi", PROGRAM="/sbin/scsi_id", ID="OEM 0815", NAME="disk1"

# USB printer to be called lp_color
LABEL, BUS="usb", serial="W09090207101241330", NAME="lp_color"

# sound card with PCI bus id 00:0b.0 to be called dsp
NUMBER, BUS="pci", ID="00:0b.0", NAME="dsp"

# USB mouse at third port of the second hub to be called mouse1
TOPOLOGY, BUS="usb", PLACE="2.3", NAME="mouse1"

# ttyUSB1 should always be called pda
REPLACE, KERNEL="ttyUSB1", NAME="pda"

# USB webcams to be called webcam0, webcam1, ...
LABEL, BUS="usb", model="WebCam Version 3", NAME="webcam%n"
.fi
.P
Permissions and ownership for the created device files may specified at
.I /etc/udev/udev.permissions
or specified by the 
.I udev_permission
value in the 
.I /etc/udev/udev.conf
file.
The file consists of a set of lines. All empty lines and
lines beginning with a '#' will be ignored.
.br
Every line lists a device name followed by owner, group and permission
mode. All values are separated by colons. The name field may end with a
wildcard to apply the values to a whole class of devices.
.br
If
.B udev
was built using klibc or is used before the user database is accessible (e.g.
.B initrd
), only numeric owner and group values may be used.
.sp
A sample \fIudev.permissions\fP might look like this:
.sp
.nf
#name:user:group:mode
input/*:root:root:644
ttyUSB1:0:8:0660
video*:root:video:0660
dsp1:::0666
.fi
.SH "FILES"
.nf
.ft B
.ft
/sbin/udev                           udev program
/etc/udev/*                          udev config files
/etc/hotplug.d/default/udev.hotplug  hotplug symlink to udev program
.fi
.LP
.SH "SEE ALSO"
.BR hotplug (8)
.PP
The
.I http://linux-hotplug.sourceforge.net/
web site.
.SH AUTHORS
.B udev
was developed by Greg Kroah-Hartman <greg@kroah.com> with much help from
Dan Stekloff <dsteklof@us.ibm.com> and many others.
